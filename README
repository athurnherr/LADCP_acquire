#======================================================================
#                    R E A D M E 
#                    doc: Sat Mar 20 23:10:10 2004
#                    dlm: Tue Jun 29 10:53:28 2021
#                    (c) 2004 A.M. Thurnherr
#                    uE-Info: 16 12 NIL 0 0 72 3 2 8 NIL ofnI
#======================================================================

=Introduction=

The LADCP_acquire2 software implements LADCP data acquisition on UN*X
systems (e.g. Linux, MacOSX, FreeBSD, etc.) using TRDI and Nortek
ADCPs. The software includes the [TRDIterm] terminal emulation program
(a portable bbtalk replacement), the [TRDIcomms] and [ttycat] programs
to determine the serial communications parameters of TRDI ADCPs, as
well as four "operator scripts" designed to provide a comfortable and
error-tolerant command-line environment for data acquisition from
single- and dual-head LADCP systems.

The (minimal) documentation assumes familiarity both with LADCP data
acquisition and with the UN*X command line. (The user is expected to
know what is meant by a UN*X "special file" and has seen the contents
of ADCP command files.) While there is no user support for this
software, bug reports sent to <athurnherr@yahoo.com> are welcome. This
[README] file contains notes on how to setup and use the LADCP_acquire2
data acquisitions software for a new cruise. For notes on installation
on different UN*X flavors see [README.*] files (e.g. [README.Linux]). 


=Connecting ADCP Heads to Acquisitions Computer=

1) physically connect the instruments
	TRDI ADCP:
		- serial connection
		- USB adapters must support the RS-232 BREAK condition
	Nortek ADCPs:
		- Ethernet connection		

2) determine the access ports
	TRDI:
		- special files of the serial ports the instruments are
   		   connected to:
		- Linux:
			/dev/ttyS0 /dev/ttyS1 for standard serial ports
			/dev/ttyUSB0 /dev/ttyUSB1 for USB2serial ports
		- FreeBSD:
			/dev/cuad0 /dev/cuad1 for standard serial ports
		- MacOSX:
			/dev/cu.* where the link name after the period
			depends on the USB adapter and port it is
			plugged into
	Nortek:
		- static IP address			



3) verify connection
	TRDI:
		- TRDIterm  <path to special file>
			- ^C to wake up instrument
			- cz to send instrument back to sleep
		- potential problems:
			- wrong special file
			- wrong serial comms settings (use TRDIcomms to
			  determine which settings are in use)
			- no power
			- bad cable
			- bad instrument			
	Nortek:
		- ping <ip address>
		- potential problems:
			- bad network setup on acquisition computer
			- no power
			- bad cable
			- bad instrument			
			

4) create/update the file [CRUISE_SETUP.expect]
	- file resides in main acquisition directory
	- at least comms ports and command file names must be specified

5) test setup
	- Ldir shows memory contents of ADCPs
	- red color: sync-pulse originator (usually: downlooker)
	- blue color: sync-pulse recipient (usually: uplooker)
		

----------------------------------------------------------------------

=Operator Scripts=

Notes:
	1) The LADCP files use sequential numbers that are independent
	   of any station, cast of profile numbers. The CTD station/cast
	   numbers for each profile are stored together with the data
	   files.
	2) No file should ever be deleted by the operator. If a cast is
	   to be aborted and restarted, Ldir can be used to stop the
	   instrument pinging; normal Lstart is used to restart the
	   cast.
	3) The acquisition software makes automatic backups after data
	   downloading and checking. Either a mounted USB or a network
	   drive can be used.
	4) Before using any of the operator scripts, the file
	   [CRUISE_SETUP.expect] must be edited to set cruise-specific
	   parameters.
	5) The shell search path must be set up to include the directory
	   with the operator scripts. It is NOT possible, to use the
	   operator scripts with full pathnames (e.g. ./Ldir)
	6) Lcheck requires installation of the mkProfile utility that is
	   part of the "ADCP tools" that are available from the same
	   server as this software.
	   

Lstart 		This command wakes the instruments, lists their memory 
		contents, clears the memory (after operator
		confirmation) and programs the instruments to start
		pinging by uploading command files. CTD station and 
		cast numbers must be provided by the operator since
		the LADCP files use an independent numbering scheme.

Ldownload 	This command interrupts the running data acquisition,
		downloads the data and backs up the data files. Note
		that all files are downloaded into the data directory
		corresponding ot the most recent LADCP profile number.
		When there are data from multiple casts present in
		an instrument, they have to be copied to the correct
		directories manually. After interrupting a download, it
		may be necessary to remove partially downloaded files
		from the current directory before restarting the
		download. 

Lcheck 		This command integrates the measured vertical velocities
		from both ADCPs to estimate zmax and zend, which are
		displayed together with other useful profile statistics
		before the data files are backed up (again).

Lerase		This command lists the memory contents and deletes all
		files after a timeout unless the operator intervenes. 


